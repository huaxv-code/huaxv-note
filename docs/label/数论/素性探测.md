# 素性探测

**Miller-Rabin 素性测试**

执行 $k$ 轮的时间复杂度为：$O(klog^3n)$，在 `long long` 范围内几乎约等于常数。

根据「二次探测定理」：

> 如果 $n$ 是奇素数，则 $x^2 \bmod n = 1$ 的解只有 $x \bmod n = 1$ 或者 $x \bmod n = n - 1$。

要证明上述等式，只需将右边的 1 移项：$(x + 1)(x - 1) \bmod n = 0$。

根据「费马小定理」：

> 在 $[2, n - 1]$ 中不断随机选取一个数 $a$，判断是否每次都有 $a^{n - 1} = 1(mod\ n)$，如果有，则 $n$ 很大可能性是素数。

结合「二次探测定理」和「费马小定理」：

> - 在 $[2, n - 1]$ 中随机选取 $a$，根据「费马小定理」要不断得判断 $a^{n - 1}$ 在同余 $n$ 的情况下是否等于 $1$，我们将 $n - 1$ 分成 $u \times 2 ^ t$，这样就有：$a^{n - 1} = a^{u \times 2 ^ t}$
> - 根据「二次探测定理」，若 $a^u == 1$，则 $n$ 很有可能是素数，通过了这轮测试；
> - 对 $a^u$ 执行最多 $t$ 次平方就可以变为 $a^{u \times 2 ^ t}$ 也就是 $a^{n - 1}$；
> - 在执行平方的过程中，如果 $a^{u \times 2^i} = n - 1$，则 $n$ 极大概率是素数，代表通过了这一轮测试，否则还要继续平方操作；
> - 若执行了 $t$ 次平方操作之后还是没能发现 $a^{u \times 2^i} = n - 1$ 则 $n$ 肯定不是素数！

代码参考：

```c++

```