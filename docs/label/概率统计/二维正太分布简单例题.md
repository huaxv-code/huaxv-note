# 二维正太分布简单例题

!!! question 

    设 $(X, Y) \sim N(0, 0, \sigma ^ 2, \sigma ^ 2, 0)$，求 $P\{X < Y\}$ 。

若随机变量 $(X, Y)$ 的概率密度函数满足：

<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="vertical-align:-3.13ex" width="101.14ex" height="7.384ex" viewBox="0 -1831.9 43546.1 3179.3"><defs><path id="o" stroke-width="1" d="M58-216q-33 0-35 30 0 10 50 212t54 208q16 55 55 107 70 86 159 100h8q6 0 10 1 73 0 112-48t39-118q0-57-24-111t-61-91-80-61-79-23h-18q-51 0-83 45l-5 6-27-112q-25-97-29-110t-12-21q-16-14-34-14zm366 538q0 37-17 60t-50 23q-35 0-70-29t-56-76q-14-31-38-130l-17-68q17-76 84-76 38 0 74 36 33 30 55 96t29 108 6 56z"/><path id="a" stroke-width="1" d="M118-162q2 0 6-2t11-3 12-1q13 0 24 13t16 29q10 27 34 153t46 240 22 115v3h-47q-47 0-50 2-4 3-4 10l7 28q2 5 8 5t47 1q48 0 48 1 0 2 9 50t12 58q37 165 146 165 37-2 61-22t24-53q0-36-21-52t-42-17q-44 0-44 42 0 19 11 33t24 21l9 5q-16 6-30 6-12 0-23-10t-15-28q-7-29-16-78t-16-83-7-36q0-2 55-2 45 0 52-1t11-6q1-4-2-17t-5-16q-2-5-9-5t-54-1h-56l-23-122Q301 15 282-47q-27-85-70-126-37-32-73-32-32 0-58 19t-26 54q0 37 21 54t42 17q44 0 44-42 0-19-11-33t-24-21l-9-5z"/><path id="c" stroke-width="1" d="M52 289q7 42 54 97t116 56q35 0 64-18t43-45q42 63 101 63 37 0 64-22t28-59q0-29-14-47t-27-22-23-4q-19 0-31 11t-12 29q0 46 50 63-11 13-40 13-13 0-19-2-38-16-56-66-60-221-60-258 0-28 16-40t35-12q37 0 73 33t49 81q3 10 6 11t16 2h4q15 0 15-8 0-1-2-11-16-57-62-101T333-11q-70 0-106 63-41-62-94-62h-6q-49 0-70 26T35 71q0 32 19 52t45 20q43 0 43-42 0-20-12-35t-23-20-13-5l-3-1q0-1 6-4t16-7 19-3q36 0 62 45 9 16 23 68t28 108 16 66q5 27 5 39 0 28-15 40t-34 12q-40 0-75-32t-49-82q-2-9-5-10t-16-2H58q-6 6-6 11z"/><path id="d" stroke-width="1" d="M78 35v25l16 43 43 18q28 0 50-25t23-88q0-35-9-68t-21-57-26-41-24-27-13-9q-4 0-13 9t-9 13q0 4 11 16t25 30 26 50 16 73V9l-1-1q-2-1-5-2t-6-3-9-2-12-1q-27 0-44 17z"/><path id="e" stroke-width="1" d="M21 287q0 14 15 48t48 71 74 36q41 0 66-23t26-64q-2-19-3-21 0-3-16-46t-33-97-16-86q0-43 14-60t42-18q23 0 43 11t31 23 27 33q0 1 5 20t14 59 19 74q38 150 42 157 13 27 43 27 13 0 21-7t11-12 2-9q0-13-49-210T391-23q-28-83-97-132t-138-50q-45 0-79 22t-34 66q0 22 7 37t19 22 20 10 17 3q44 0 44-42 0-20-12-35t-23-20-13-5l-3-1q2-5 19-12t34-7h8q17 0 26 2 33 9 61 38t43 62 23 56 8 30l-6-4q-6-4-19-11T270-6q-20-5-39-5-46 0-81 22t-46 71q-1 7-1 31 0 57 35 149t35 117v14q0 3-4 7t-11 4h-4q-23 0-42-19t-30-41-17-42-8-22q-2-2-16-2H27q-6 6-6 9z"/><path id="f" stroke-width="1" d="M60 749l4 1h22l28-24q94-85 137-212t43-264q0-68-10-131T261 12t-37-88-38-67-41-51-32-33-23-19l-4-4H63q-3 0-5 3t-3 9q1 1 11 13Q221-64 221 250T66 725q-10 12-11 13 0 8 5 11z"/><path id="g" stroke-width="1" d="M56 347q0 13 14 20h637q15-8 15-20 0-11-14-19l-318-1H72q-16 5-16 20zm0-194q0 15 16 20h636q14-10 14-20 0-13-15-20H70q-14 7-14 20z"/><path id="i" stroke-width="1" d="M109 429q-27 0-43 18t-16 44q0 71 53 123t132 52q91 0 152-56t62-145q0-43-20-82t-48-68-80-74q-36-31-100-92l-59-56 76-1q157 0 167 5 7 2 24 89v3h40v-3q-1-3-13-91T421 3V0H50v31q0 7 6 15t30 35q29 32 50 56 9 10 34 37t34 37 29 33 28 34 23 30 21 32 15 29 13 32 7 30 3 33q0 63-34 109t-97 46q-33 0-58-17t-35-33-10-19q0-1 5-1 18 0 37-14t19-46q0-25-16-42t-45-18z"/><path id="j" stroke-width="1" d="M132-11q-34 0-34 33v11l13 28q75 158 109 273l8 24h-32q-38 0-54-3t-39-19q-11-7-22-18t-19-21-9-12q-2-1-15-1-19 0-19 10 0 6 19 35t55 62 71 38q7 2 225 2 160 0 164-1 20-7 20-28 0-31-32-42-6-2-69-2h-64l-3-17q-12-72-12-119 0-52 9-93t19-64 10-28q0-17-14-32t-36-15q-11 0-18 3t-16 24-16 60q-1 9-1 44 0 49 9 105t18 92 10 40h-98l-1-4q0-3-19-79t-43-161-31-97q-11-28-43-28z"/><path id="k" stroke-width="1" d="M184-11q-68 0-110 45T31 147q0 100 73 186t170 97q1 1 140 1h138q1-1 3-2t4-2 3-2 3-3 2-2 2-4 1-4 1-5 1-6q0-44-65-44h-17q-10 0-14 1h-60l5-10q18-38 18-85 0-110-80-192T184-11zm177 289q0 80-85 80-124 0-161-174-1-4-1-6-8-37-8-61 0-50 25-70t57-21q54 0 99 47 29 30 47 80t22 80 5 45z"/><path id="l" stroke-width="1" d="M213 578l-13-5q-14-5-40-10t-58-7H83v46h19q47 2 87 15t56 24 28 22q2 3 12 3 9 0 17-6V361l1-300q7-7 12-9t24-4 62-2h26V0h-11q-21 3-159 3-136 0-157-3H88v46h64q16 0 25 1t16 3 8 2 6 5 6 4v517z"/><path id="n" stroke-width="1" d="M84 237v13l14 20h581q15-8 15-20t-15-20H98q-14 7-14 20z"/><path id="b" stroke-width="1" d="M94 250q0 69 10 131t23 107 37 88 38 67 42 52 33 34 25 21h17q14 0 14-9 0-3-17-21t-41-53-49-86-42-138-17-193 17-192 41-139 49-86 42-53 17-21q0-9-15-9h-16l-28 24q-94 85-137 212T94 250z"/><path id="m" stroke-width="1" d="M1001 1150q16 0 19-18 0-5-279-888L460-643q-7-7-24-7h-12q-1 3-1 5t-2 5-2 9-4 14-7 23-9 34-14 48-18 64-24 84-31 105L203 119l-65-78-27 26 101 121 52 60 208-722 511 1614q5 10 18 10z"/><path id="h" stroke-width="1" d="M701-940q0-3-6-9h-31q-2 2-28 27t-45 43-54 61-62 81-63 101-62 125-55 149-45 176-29 203-12 234q0 711 364 1110 23 25 43 44t33 32 15 13h31q6-6 6-9 0-5-20-26t-52-59-72-95-81-143-76-191-60-252-32-316q-2-38-2-109 0-389 94-680t290-494q11-12 11-16z"/><path id="p" stroke-width="1" d="M34 1438q0 8 3 10t13 2h21q2-2 28-27t45-43 54-61 62-81 63-101 62-124 55-149 45-176 29-203 12-234q0-117-7-198-47-572-357-913-23-25-43-44t-33-32-15-13H56q-13 0-17 2t-5 10q54 54 106 124Q428-430 428 251q0 202-26 377t-64 294-93 224-100 163-99 116l-4 4q-2 2-3 4t-3 3l-2 2z"/><path id="q" stroke-width="1" d="M39 168q0 57 19 104t49 78 67 52 70 31 63 9h3q45 0 78-22t33-65q0-90-111-118-49-13-134-14-37 0-38-2 0-2-6-35t-7-58q0-47 21-74t63-28 93 19 92 66q9 10 12 10 4 0 13-9t10-14-9-16-30-27-46-31-63-25-76-10q-79 0-122 53T39 168zm334 185q-6 52-68 52-33 0-61-14t-45-34-29-41-16-36-5-19q0-1 20-1 113 0 158 24t46 69z"/><path id="r" stroke-width="1" d="M23 287q1 3 2 8t5 22 10 31 15 33 20 30 26 22 33 9q75 0 96-64l10 9q62 55 118 55 65 0 102-47t37-114q0-108-76-199T249-10q-22 0-39 6-11 5-23 15t-19 17l-7 8q-1-1-22-87t-21-87q0-6 8-7t37-3h25q6-7 6-9t-3-18q-3-12-6-15t-13-4h-11q-9 0-34 1t-62 1q-70 0-89-2h-8q-7 7-7 11 2 27 13 35h20q34 1 39 12 3 6 61 239t61 247q1 5 1 14 0 41-25 41-22 0-37-28t-23-61-12-36q-2-2-16-2H29q-6 6-6 9zm155-185q22-76 74-76 30 0 58 23t46 58q18 34 36 108t19 110v6q0 74-61 74-11 0-22-3t-22-9-20-13-17-15-15-15-11-14-8-10l-3-4q0-1-3-14t-11-44-14-52q-26-106-26-110z"/><path id="u" stroke-width="1" d="M58-216q-14 0-24 8t-11 22q0 10 73 302t77 298q13 28 46 28 12-1 20-7t10-12 2-10q0-12-31-134t-33-137q-2-11-2-35v-8q0-73 67-73 9 0 18 1t17 4 15 7 13 7 12 10 11 10 10 12 8 11 9 12l7 10 36 143q36 142 40 151 13 27 43 27 13 0 21-7t11-12 2-10L449 84q-1-5-1-16 0-25 7-33t21-9q9 1 20 9 21 20 41 96 6 20 10 21 2 1 10 1h4q19 0 19-9 0-6-5-27t-20-54-32-50Q510 0 491-8q-8-2-24-2-21 0-38 6t-27 15-17 18-9 15-2 7l-6-6q-6-6-18-15t-26-18-36-16-42-7q-47 0-93 23l-24-97q-21-82-25-95t-12-22q-16-14-34-14z"/><path id="v" stroke-width="1" d="M56 237v13l14 20h299v150l1 150q10 13 19 13 13 0 20-15V270h298q15-8 15-20t-15-20H409V-68q-8-14-18-14h-4q-12 0-18 14v298H70q-14 7-14 20z"/><path id="t" stroke-width="1" d="M758-1237v-3l-6-9h-16q-18 0-19 1-6 3-45 49Q237-706 237 251t435 1449q25 30 44 49 2 1 19 1h17q6-6 6-9 0-4-18-28t-51-69-70-107-79-157-77-204Q348 802 348 251q0-493 93-850t303-619q14-19 14-22z"/><path id="w" stroke-width="1" d="M33 1741q0 9 18 9h14q8 0 16-7t38-43q435-493 435-1449 0-958-435-1450-43-51-53-51h-4q-3 0-6 1h-3q-2 0-4-1-16 0-16 11 0 3 17 25t48 64 65 98 75 142 73 183q132 392 132 978 0 151-7 281t-31 299-66 311-115 296-174 278q-17 21-17 25z"/><path id="s" stroke-width="1" d="M269-1249v2999h308v-73H342v-2853h235v-73H269z"/><path id="x" stroke-width="1" d="M5 1677v73h308v-2999H5v73h235v2853H5z"/></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="scale(1 -1)"><use xlink:href="#a"/><g transform="translate(717)"><use xlink:href="#b"/><use x="389" xlink:href="#c"/><use x="962" xlink:href="#d"/><use x="1407" xlink:href="#e"/><use x="1904" xlink:href="#f"/></g><use x="3289" xlink:href="#g"/><g transform="translate(4345)"><use xlink:href="#h"/><use x="736" xlink:href="#i"/><use x="1237" xlink:href="#j"/><g transform="translate(1810)"><use xlink:href="#k"/><use x="808" y="-213" transform="scale(.707)" xlink:href="#l"/></g><g transform="translate(2835)"><use xlink:href="#k"/><use x="808" y="-213" transform="scale(.707)" xlink:href="#i"/></g><g transform="translate(3861)"><use y="59" xlink:href="#m"/><path stroke="none" d="M1000 1150h2694v60H1000z"/><g transform="translate(1000)"><use xlink:href="#l"/><use x="722" xlink:href="#n"/><g transform="translate(1723)"><use xlink:href="#o"/><use x="731" y="583" transform="scale(.707)" xlink:href="#i"/></g></g></g><use x="7556" y="-1" xlink:href="#p"/><g transform="matrix(.707 0 0 .707 8293 1177)"><use xlink:href="#n"/><use x="778" xlink:href="#l"/></g></g><use x="13642" xlink:href="#q"/><use x="14109" xlink:href="#c"/><use x="14681" xlink:href="#r"/><g transform="translate(15352)"><use xlink:href="#s"/><use x="583" xlink:href="#n"/><g transform="translate(1482)"><path stroke="none" d="M0 220h4261v60H0z"/><use x="1880" y="676" xlink:href="#l"/><g transform="translate(60 -736)"><use xlink:href="#i"/><g transform="translate(667)"><use xlink:href="#b"/><use x="389" xlink:href="#l"/><use x="1112" xlink:href="#n"/><g transform="translate(2112)"><use xlink:href="#o"/><use x="731" y="408" transform="scale(.707)" xlink:href="#i"/></g><use x="3084" xlink:href="#f"/></g></g></g><g transform="translate(5863)"><use xlink:href="#t"/><path stroke="none" d="M912 220h4205v60H912z"/><g transform="translate(972 725)"><use xlink:href="#b"/><use x="389" xlink:href="#c"/><use x="1184" xlink:href="#n"/><g transform="translate(2184)"><use xlink:href="#u"/><use x="853" y="-213" transform="scale(.707)" xlink:href="#l"/></g><use x="3242" xlink:href="#f"/><use x="5136" y="675" transform="scale(.707)" xlink:href="#i"/></g><g transform="translate(2501 -792)"><use xlink:href="#k"/><use x="810" y="488" transform="scale(.707)" xlink:href="#i"/><use x="808" y="-435" transform="scale(.707)" xlink:href="#l"/></g><use x="5460" xlink:href="#n"/><path stroke="none" d="M6580 220h8660v60H6580z"/><g transform="translate(6640 725)"><use xlink:href="#i"/><use x="500" xlink:href="#o"/><g transform="translate(1184)"><use xlink:href="#b"/><use x="389" xlink:href="#c"/><use x="1184" xlink:href="#n"/><g transform="translate(2184)"><use xlink:href="#u"/><use x="853" y="-213" transform="scale(.707)" xlink:href="#l"/></g><use x="3242" xlink:href="#f"/></g><g transform="translate(4983)"><use xlink:href="#b"/><use x="389" xlink:href="#e"/><use x="1109" xlink:href="#n"/><g transform="translate(2109)"><use xlink:href="#u"/><use x="853" y="-213" transform="scale(.707)" xlink:href="#i"/></g><use x="3167" xlink:href="#f"/></g></g><g transform="translate(9884 -686)"><use xlink:href="#k"/><use x="808" y="-213" transform="scale(.707)" xlink:href="#l"/><g transform="translate(1025)"><use xlink:href="#k"/><use x="808" y="-213" transform="scale(.707)" xlink:href="#i"/></g></g><use x="15583" xlink:href="#v"/><g><path stroke="none" d="M16703 220h4130v60h-4130z"/><g transform="translate(16763 725)"><use xlink:href="#b"/><use x="389" xlink:href="#e"/><use x="1109" xlink:href="#n"/><g transform="translate(2109)"><use xlink:href="#u"/><use x="853" y="-213" transform="scale(.707)" xlink:href="#i"/></g><use x="3167" xlink:href="#f"/><use x="5030" y="675" transform="scale(.707)" xlink:href="#i"/></g><g transform="translate(18255 -792)"><use xlink:href="#k"/><use x="810" y="488" transform="scale(.707)" xlink:href="#i"/><use x="808" y="-435" transform="scale(.707)" xlink:href="#i"/></g></g><use x="20954" xlink:href="#w"/></g><use x="27610" y="-1" xlink:href="#x"/></g></g></svg>

就称随机变量 $(X, Y)$ 服从二维正太分布，记作：$(X, Y) \sim N(\mu _1, \mu _2, \sigma _1 ^ 2, \sigma _2 ^ 2, \rho)$

---

由题意可知概率密度函数为：
> $f(x, y) = \frac{1}{2\pi \sigma ^ 2}e ^ {-\frac{x ^ 2 + y ^ 2}{2 \sigma ^ 2}}$

所以若要求 $P\{X < Y\}$ 的概率，需要先将 $Y$ 固定下来，则 $X$ 的取值范围为：$-\infty < X < Y$:
> $P\{X < Y\} = \int_{-\infty}^{+\infty}\int_{-\infty}^{Y}\frac{1}{2\pi \sigma ^ 2}e ^ {-\frac{x ^ 2 + y ^ 2}{2 \sigma ^ 2}}dxdy$

转换成极坐标，将定义域的面积单元在无限小的情况下，几乎相同，所以对于 $(dx, dy)$ 和 $(dr, d\theta)$ 在无限小的情况下分的到的面积可以画上等号：
> $dxdy = rdrd\theta$

令 $x = r\cos \theta, y = r \sin \theta$，则 $X < Y$ 可以表示成：
> $\theta \in [\frac{\pi}{4}, \frac{5\pi}{4}]$

所以原积分式用极坐标表示如下：
> $\int_{\frac{\pi}{4}}^{\frac{5\pi}{4}}\int_{0}^{+\infty}\frac{1}{2\pi \sigma ^ 2}e ^ {-\frac{r ^ 2}{2 \sigma ^ 2}}rdrd\theta$
>
> 结果为：$\frac{1}{2}$ 