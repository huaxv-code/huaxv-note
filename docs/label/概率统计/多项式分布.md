# 多项式分布

我们将一个试验独立的进行一次，其完备事件群为：$\{A_1, A_2, \cdots , A_n\}$ ，且事件群中，任意两个事件相互排斥，不可能同时发生多个，一次只能且必定发生其中一个。

对于事件 $A_i$ 发生的概率为 $p_i$，则 $p_1 + p_2 + \cdots + p_n = 1$。

我们将试验独立的进行 $N$ 次，记 $k_i$ 为事件 $A_i$ 发生的次数，则 $k_1 + k_2 + \cdots + k_n = N$。

$p(k_1, k_2, \cdots, k_n) = \frac{N!}{k_1!k_2!\cdots k_n!} p_1^{k_1} p_2^{k_2} \cdots p_n^{k_n}$，想象成将 $N$ 分成大小分别为 $k_1, k_2, \cdots k_n$ 的堆。

由于 $k_1, k_2, \cdots , k_n$ 的值并不固定，只需要满足 $k_i$ 是非负整数，$k_1 + k_2 + \cdots + k_n = N$ 即可。

所以 $k_1, k_2, \cdots , k_n$ 的全概率和为：

$$
\sum_{k_1, k_2, \cdots, k_n}^{*}\frac{N!}{k_1!k_2!\cdots k_n!} p_1^{k_1} p_2^{k_2} \cdots p_n^{k_n} = (p_1 + p_2 + \cdots + p_n) ^ N = 1
$$

由于全概率求和公式化简的结果与 {== 多项式公式$(x_1 + x_2 + \cdots + x_n) ^ N$ ==} 一致，就称呼为 {== 多项式分布 ==}。

对于式子 $\frac{N!}{k_1!k_2!\cdots k_n!} x_1^{k_1} x_2^{k_2} \cdots x_n^{k_n}$，若分母的和等于分子，即 $k_1 + k_2 + \cdots + k_n = N$，且右边为随机变量 $x_i^{k_i}$ 其求和公式就可以化简成多项式的形式：$(x_1 + x_2 + \cdots + x_n) ^ N$。

## 固定一个试验结果发生的次数，求概率

!!! question

    某种试验的结果为：$A_1, A_2, \cdots , A_n$ 中的一种，并且每一种可能的结果互相排斥；
    
    对于结果 $A_i$ 发生的概率为：$p_i$；

    若对该试验独立进行了 $N$ 次，求试验结果 $A_1$ 发生 $k_1$ 次的概率。

---

**思路一：**

将 $N$ 分成大小分别为 $k_1、N - k_1$ 的两个堆，则有 $\frac{N!}{k_1!(N - k_1)!}$ 种划分方法；

其中大小为 $k_1$ 的堆为 $A_1$ 发生所在的堆，剩下的大小为 $N - k_1$ 的堆由剩下的试验结果 $A_2、\cdots、A_n$ 发生的次数构成；

我们将试验结果 $A_1$ 独立出去，将剩下的试验结果看成是某种试验 $B$ 进行一次的可能取值，则对于 $A_i, i \geq 2$ 在试验 $B$ 中发生的可能性为：$\frac{p_i}{1 - p_i}$

由全概率和公式：

$$
\begin{aligned}
\sum_{k_2、k_3、\cdots 、k_n}^{*}\frac{N(N-k_1)!}{k_2!k_3! \cdots k_n!}(\frac{p_2}{1 - p_1})^{k_2}(\frac{p_3}{1 - p_1})^{k_3} \cdots (\frac{p_n}{1 - p_1})^{k_n} \\ = (\frac{p_2}{1 - p_1} + \frac{p_3}{1 - p_1} + \cdots + \frac{p_n}{1 - p_1}) ^ N = 1
\end{aligned}
$$

所以 $A_1$ 固定发生 $k_1$ 次的概率为:
> $\frac{N!}{k_1!(N-k_1)!}p_1^{k_1}(1 - p_1)^(N - k_1)$

---

**思路二：**

由于 $k_1$ 固定，但 $k_2、k_3、\cdots 、k_n$ 不是固定，所以概率和为：

$$
\begin{aligned}
    \sum^{*}_{k_2, k_3, \cdots , k_n} \frac{N!}{k_1!k_2!\cdots k_n!} p_1^{k_1}p_2^{k_2}\cdots p_n^{k_n}
\end{aligned}
$$

将固定的值都提取出来：

$$
\begin{aligned}
    \frac{N!}{k_1!}p_1^{k_1} \sum^{*}_{k_2!, ,k_3!,\cdots, k_n!}\frac{1}{k_2!k_3!\cdots k_n!}p_2^{k_2}p_3^{k_3}\cdots p_n^{k_n}
\end{aligned}
$$

化简成多项式的形式，分母的和为分子，右边为分母各项的次方：

$$
\begin{aligned}
    \frac{N!}{k_1!(N - k_1)!}p_1^{k_1}(1 - p_1)^{N - k_1} \sum_{k_2,k_3,\cdots,k_n}^{*}\frac{(N - k_1)!}{k_2!k_3!\cdots k_n!}(\frac{p_2}{1 - p_1})^{k_2}(\frac{p_3}{1 - p_1})^{k_3} \cdots (\frac{p_n}{1 - p_1})^{k_n}
\end{aligned}
$$

化简成多项式的形式：

$$
\begin{aligned}
    \frac{N!}{k_1!(N - k_1)!}p_1^{k_1}(1 - p_1)^{N - k_1} (\frac{p_2}{1 - p_1} + \frac{p_3}{1 - p_1} + \cdots + \frac{p_n}{1 - p_1}) ^ N
\end{aligned}
$$

结果为：
> $\frac{N!}{k_1!(N - k_1)!}p_1^{k_1}(1 - p_1)^{N - k_1}$

---

**思路三：**

想象成二项分布事件，实验结果 $A_1$ 发生了 $k_1$ 次，没有发生 $N - k_1$ 次的概率为:

> $\frac{N!}{k_1!(N - k_1)!}p_1^{k_1}(1 - p_1)^{N - k_1}$

**结论：若要求某试验结果 $A_i$ 固定发生了 $k_i$ 次的概率，只需要当作二项分布 $b(k_i; N, p_i)$ 来求就行。**

## 推广到多个试验结果固定次数，求概率

!!! question

    若一个试验的试验结果是 $\{A_1, A_2, \cdots , A_n\}$ 中的一种，且上面的试验结果互相排斥，每一次试验有且仅有一种试验结果发生，对于任意一个试验结果 $A_i$ 发生的概率为 $p_i$。

    若对该试验进行了 $N$ 次，请你求试验结果 $A_1、A_2、\cdots 、A_s$ 分别发生 $k_1、k_2、\cdots 、k_s$ 次的概率。

将 $N$ 分成大小分别为：$k_1、k_2、\cdots、k_s、(N - k_1 - k_2 - \cdots - k_s)$ 的堆，总共有多少种分法：
> 总共有 $\frac{N!}{k_1!k_2!\cdots k_s!(N - k_1 - k_2 - \cdots - k_s)!}$ 种分法

假设有这样的试验 $B$ 其试验结果为：$A_{s+1} \cdots A_n$，且对于任意的试验结果 $A_i(i \geq s + 1)$ 来说，其发生的概率为：$\frac{p_i}{1 - (p_1 + p_2 + \cdots p_s)}$

所以题目所求的概率为：
> $\frac{N!}{k_1!k_2!\cdots k_s!(N - k_1 - k_2 - \cdots - k_s)!}p_1^{k_1} \cdots p_s^{k_s} \times (1 - p_1 - \cdots p_s) ^ (N - k_1 - \cdots k_s)$
> 
> $\times$
> 
> $\sum_{k_{s + 1} \cdots k_n}^{*}\frac{(N - k_1 - \cdots k_s)!}{k_{s + 1}!k_{s + 2}!\cdots, k_n!}(\frac{p_{s + 1}}{1 - k_1 - \cdots k_s}) ^ {k_{s + 1}} \cdots (\frac{p_n}{1 - k_1 - \cdots k_s}) ^ {k_n}$
> 
> $=$
>
> $\frac{N!}{k_1!k_2!\cdots k_s!(N - k_1 - k_2 - \cdots - k_s)!}p_1^{k_1} \cdots p_s^{k_s} \times (1 - p_1 - \cdots p_s) ^ (N - k_1 - \cdots k_s)$

**结论：若将某些试验结果固定发生多少次，叫你求这样的概率，只需要将试验次数 $N$ 分成大小分别为 $k_1、k_2、\cdots 、k_s 、(N - k_1 - k_2 - \cdots - k_s)$ 的堆，分别代表事件 $A_1、A_2、\cdots 、A_s、\bar{A}$ 发生的次数，每一个试验分别发生的概率分别对应 $p_1、p_2、\cdots 、p_s、(1 - p_1、p_2、\cdots 、p_s)$，求这样的概率**

## 在多项式分布中，在已知某事件固定发生了几次的情况下，求另一事件发生某次的概率

